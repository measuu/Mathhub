import random

from fastapi import APIRouter, HTTPException

router = APIRouter()

math_facts = [
    # ----- GEOMETRY -----
    {
        "id": 1,
        "type": "geometry",
        "text": "Сума кутів будь-якого трикутника завжди дорівнює 180°.",
    },
    {
        "id": 2,
        "type": "geometry",
        "text": "У колі число π визначається як відношення довжини кола до його діаметра.",
    },
    {
        "id": 3,
        "type": "geometry",
        "text": "У правильному шестикутнику радіус описаного кола дорівнює довжині сторони.",
    },
    {
        "id": 4,
        "type": "geometry",
        "text": "Трикутник із сторонами 3, 4 і 5 — прямокутний.",
    },
    {
        "id": 5,
        "type": "geometry",
        "text": "Усі правильні многокутники можна вписати у коло.",
    },
    {"id": 6, "type": "geometry", "text": "Куб має 12 ребер, 8 вершин і 6 граней."},
    # ----- ALGEBRA -----
    {
        "id": 7,
        "type": "algebra",
        "text": "Дискримінант визначає кількість коренів квадратного рівняння.",
    },
    {"id": 8, "type": "algebra", "text": "Будь-яке число в степені 0 дорівнює 1."},
    {"id": 9, "type": "algebra", "text": "Множення — це повторюване додавання."},
    {
        "id": 10,
        "type": "algebra",
        "text": "Корінь із від'ємного числа — це уявне число.",
    },
    {
        "id": 11,
        "type": "algebra",
        "text": "Лінійні рівняння завжди мають або один корінь, або жодного.",
    },
    # ----- NUMBER THEORY -----
    {"id": 12, "type": "number_theory", "text": "2 — єдине парне просте число."},
    {
        "id": 13,
        "type": "number_theory",
        "text": "Простих чисел нескінченно багато — це довів Евклід.",
    },
    {
        "id": 14,
        "type": "number_theory",
        "text": "1 не є ні простим, ні складеним числом.",
    },
    {
        "id": 15,
        "type": "number_theory",
        "text": "Будь-яке число, поділене саме на себе, дає 1.",
    },
    {
        "id": 16,
        "type": "number_theory",
        "text": "Фібоначчі не відкрив послідовність Фібоначчі — він її популяризував.",
    },
    {
        "id": 17,
        "type": "number_theory",
        "text": "Послідовність Фібоначчі зустрічається в природі: у квітах, мушлях, шишках.",
    },
    # ----- PARADOXES -----
    {
        "id": 18,
        "type": "paradox",
        "text": "Парадокс Рассела описує множину всіх множин, які не містять самі себе.",
    },
    {
        "id": 19,
        "type": "paradox",
        "text": "Парадокс Зенона про Ахіллеса та черепаху стверджує, що швидший не може наздогнати повільнішого.",
    },
    {
        "id": 20,
        "type": "paradox",
        "text": "Парадокс день народження: у групі з 23 людей 50% шанс, що двоє мають однаковий день народження.",
    },
    {
        "id": 21,
        "type": "paradox",
        "text": "Парадокс банах–тарського: можна розрізати кулю на частини та скласти з них дві таких самих кулі.",
    },
    # ----- HISTORY -----
    {
        "id": 22,
        "type": "history",
        "text": "Піфагор не відкрив теорему Піфагора — вона була відома за тисячу років до нього.",
    },
    {
        "id": 23,
        "type": "history",
        "text": "Архімед кричав 'Еврика!' коли відкрив спосіб визначити густину.",
    },
    {
        "id": 24,
        "type": "history",
        "text": "Ісаак Ньютон відкрив інтегральне та диференціальне числення.",
    },
    {
        "id": 25,
        "type": "history",
        "text": "Гаус у 10 років обчислив суму чисел від 1 до 100 за кілька секунд.",
    },
    # ----- FUN -----
    {
        "id": 26,
        "type": "fun",
        "text": "Якщо обернути число 1089, вийде 9801 — перевір!",
    },
    {
        "id": 27,
        "type": "fun",
        "text": "Число 73 — улюблене число Шелдона Купера, бо воно 21-ше просте, а 21 — це 12 у зворотному порядку.",
    },
    {"id": 28, "type": "fun", "text": "0! = 1 — навіть якщо це здається дивним."},
    {
        "id": 29,
        "type": "fun",
        "text": "У будь-якому натовпі є людина з тим же кількістю волосся, що і в тебе.",
    },
    # ----- BIG NUMBERS -----
    {
        "id": 30,
        "type": "big_numbers",
        "text": "Гугол — це число 10^100 (1 і 100 нулів).",
    },
    {
        "id": 31,
        "type": "big_numbers",
        "text": "Найбільше відоме просте число має понад 20 мільйонів цифр.",
    },
    {
        "id": 32,
        "type": "big_numbers",
        "text": "Гуголплекс — це 10^(10^100). Це більше, ніж кількість атомів у Всесвіті.",
    },
    # ----- EXTRA FACTS -----
    {
        "id": 33,
        "type": "algebra",
        "text": "Сума перших n натуральних чисел дорівнює n(n+1)/2.",
    },
    {
        "id": 34,
        "type": "fun",
        "text": "Число π ніколи не повторюється і не закінчується.",
    },
    {
        "id": 35,
        "type": "geometry",
        "text": "У сфері всі точки однаково віддалені від центру.",
    },
    {
        "id": 36,
        "type": "paradox",
        "text": "Парадокс Монті Холла підвищує шанс виграшу, якщо змінити вибір на другі двері.",
    },
    {
        "id": 37,
        "type": "number_theory",
        "text": "Число 6 — досконале: сума його дільників = 6.",
    },
    {
        "id": 38,
        "type": "history",
        "text": "Декарт увів систему координат, яку ми використовуємо досі.",
    },
    {
        "id": 39,
        "type": "geometry",
        "text": "У колі діаметр — найбільший можливий хордовий відрізок.",
    },
    {"id": 40, "type": "fun", "text": "Число 111,111,111² = 12,345,678,987,654,321."},
    {"id": 41, "type": "geometry", "text": "У паралелограма протилежні сторони рівні."},
    {"id": 42, "type": "algebra", "text": "Логарифм добутку = сума логарифмів."},
    {
        "id": 43,
        "type": "number_theory",
        "text": "Прості числа — будівельні блоки натуральних чисел.",
    },
    {
        "id": 44,
        "type": "big_numbers",
        "text": "Скінченних чисел менше, ніж нескінченних, але нескінченностей існує багато видів.",
    },
    {
        "id": 45,
        "type": "fun",
        "text": "Якщо перевернути калькулятор, можна скласти слова чисел.",
    },
    {
        "id": 46,
        "type": "fun",
        "text": "У багатьох мовах числові слова мають давнє символічне значення.",
    },
    {
        "id": 47,
        "type": "geometry",
        "text": "У трапеції тільки одна пара протилежних сторін паралельна.",
    },
    {
        "id": 48,
        "type": "history",
        "text": "Лейбніц і Ньютон одночасно відкрили диференціальне числення.",
    },
    {
        "id": 49,
        "type": "paradox",
        "text": "Парадокс Сімпсона: тренд у групах може бути протилежним тренду в сумі.",
    },
    {
        "id": 50,
        "type": "fun",
        "text": "1 + 2 + 3 + ... + ∞ «дорівнює» -1/12 (у теорії Рамануджана).",
    },
]


@router.get("/random")
def get_random_fact(type: str | None = None):
    if type:
        filtered = [f for f in math_facts if f["type"] == type]
        if not filtered:
            raise HTTPException(status_code=404, detail="Немає фактів цього типу")
        return random.choice(filtered)

    return random.choice(math_facts)


@router.get("/all")
def get_all_facts():
    return math_facts


@router.get("/id/{fact_id}")
def get_fact_by_id(fact_id: int):
    for fact in math_facts:
        if fact["id"] == fact_id:
            return fact
    raise HTTPException(status_code=404, detail="Факт не знайдено")
